GLOBAL
GRAB 300
LINK 800
COPY 4 T
MARK T
SWIZ 8795 T #AUTH
SWIZ 0152 T #AUTH
SWIZ 3016 T #AUTH
SWIZ 2420 T #AUTH
SUBI T 1 T
TJMP T
REPL LEFT
REPL RIGHT

COPY #TRAK M
COPY 1 T

MARK LOOP
SEEK -1
ADDI 10 T T
MARK WAIT
SUBI T 1 T
TJMP WAIT
TEST MRD
TJMP LOOP

COPY #TRAK M
COPY F M
JUMP LOOP


MARK LEFT
LINK 801
JUMP GRAB


MARK NEXT_GRAB
NOOP
COPY 11 T
MARK WAIT_GRAB
SUBI T 1 T
TJMP WAIT_GRAB
TEST MRD
TJMP NEXT_GRAB

MARK GRAB
GRAB M
REPL NEXT_GRAB
COPY F M
MARK SEND
@REP 12
COPY F M
@END
JUMP SEND


MARK RIGHT
LINK 800

MARK RECV_START
COPY 31 X
MAKE
MARK RECV
@REP 11
COPY M F
@END
SUBI X 10 X
COPY M F
TEST MRD
TJMP RECV

COPY X T
REPL RECV_START
COPY M X
MARK RECV_WAIT
SUBI T 1 T
TJMP RECV_WAIT
SEEK -999
MARK CHECK
TEST F > 0
TJMP CHECK
SEEK -1
COPY X F
JUMP CHECK